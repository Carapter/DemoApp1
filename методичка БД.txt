CREATE TABLE MATERIAL_TYPE (
    MATERIAL_TYPE_ID INTEGER GENERATED BY DEFAULT AS IDENTITY (START WITH 1),
    MATERIAL_TYPE_NAME VARCHAR(100),
    PERCENTAGE_DEFECTIVE_MATERIAL DECIMAL(5,4),
    CONSTRAINT INTEG_2 PRIMARY KEY (MATERIAL_TYPE_ID) USING ASCENDING INDEX RDB$PRIMARY2);

CREATE TABLE PARTNER (
    PARTNER_ID INTEGER GENERATED BY DEFAULT AS IDENTITY (START WITH 1),
    PARTNER_NAME VARCHAR(100),
    DIRECTOR VARCHAR(100),
    DIRECTOR_MAIL VARCHAR(100),
    DIRECTOR_PHONE VARCHAR(25),
    PARTNER_LEGAL_ADDRESS VARCHAR(100),
    PARTNER_INN VARCHAR(100),
    PARTNER_RATING INTEGER,
    PARTNER_TYPE INTEGER,
    CONSTRAINT INTEG_7 PRIMARY KEY (PARTNER_ID) USING ASCENDING INDEX RDB$PRIMARY6,
    CONSTRAINT INTEG_8 FOREIGN KEY (PARTNER_TYPE) REFERENCES PARTNER_TYPE (PARTNER_TYPE_ID) USING ASCENDING INDEX RDB$FOREIGN7);

CREATE TABLE PARTNER_TYPE (
    PARTNER_TYPE_ID INTEGER GENERATED BY DEFAULT AS IDENTITY (START WITH 1),
    PARTNER_TYPE_NAME VARCHAR(100),
    CONSTRAINT INTEG_6 PRIMARY KEY (PARTNER_TYPE_ID) USING ASCENDING INDEX RDB$PRIMARY5);

CREATE TABLE PRODUCT (
    PRODUCT_ARTICLE VARCHAR(7) NOT NULL,
    PRODUCT_NAME VARCHAR(100),
    MINIMUM_COST_FOR_PARTNER DECIMAL(15,2),
    PRODUCT_TYPE INTEGER,
    CONSTRAINT INTEG_4 PRIMARY KEY (PRODUCT_ARTICLE) USING ASCENDING INDEX RDB$PRIMARY3,
    CONSTRAINT INTEG_5 FOREIGN KEY (PRODUCT_TYPE) REFERENCES PRODUCT_TYPE (PRODUCT_TYPE_ID) USING ASCENDING INDEX RDB$FOREIGN4);

CREATE TABLE PRODUCT_MATERIAL_TYPE (
    PRODUCT_MATERIAL_TYPE_ID INTEGER GENERATED BY DEFAULT AS IDENTITY (START WITH 1),
    PRODUCT VARCHAR(7),
    MATERIAL_TYPE INTEGER,
    CONSTRAINT INTEG_12 PRIMARY KEY (PRODUCT_MATERIAL_TYPE_ID) USING ASCENDING INDEX RDB$PRIMARY11,
    CONSTRAINT INTEG_13 FOREIGN KEY (PRODUCT) REFERENCES PRODUCT (PRODUCT_ARTICLE) USING ASCENDING INDEX RDB$FOREIGN12,
    CONSTRAINT INTEG_14 FOREIGN KEY (MATERIAL_TYPE) REFERENCES MATERIAL_TYPE (MATERIAL_TYPE_ID) USING ASCENDING INDEX RDB$FOREIGN13);

CREATE TABLE PRODUCT_TYPE (
    PRODUCT_TYPE_ID INTEGER GENERATED BY DEFAULT AS IDENTITY (START WITH 1),
    PRODUCT_TYPE_NAME VARCHAR(100),
    PRODUCT_TYPE_COEFFICIENT DECIMAL(10,2),
    CONSTRAINT INTEG_1 PRIMARY KEY (PRODUCT_TYPE_ID) USING ASCENDING INDEX RDB$PRIMARY1);


CREATE TABLE SALE (
    SALE_ID INTEGER GENERATED BY DEFAULT AS IDENTITY (START WITH 1),
    PRODUCT_ARTICLE VARCHAR(7),
    PARTNER INTEGER,
    PRODUCT_COUNT INTEGER,
    CONSTRAINT INTEG_10 FOREIGN KEY (PARTNER) REFERENCES PARTNER (PARTNER_ID) USING ASCENDING INDEX RDB$FOREIGN9,
    CONSTRAINT INTEG_11 FOREIGN KEY (PRODUCT_ARTICLE) REFERENCES PRODUCT (PRODUCT_ARTICLE) USING ASCENDING INDEX RDB$FOREIGN10);

    
product type
material type
product import
product type

partner type - создавай сам
зао 1
ООо 2
пао 3
оао 4

=ВПР( {Поле, куда вставляем} ; {поля с зао 1 и тд.} ; 2 ; 0)
